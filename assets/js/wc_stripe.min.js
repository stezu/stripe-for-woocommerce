Stripe.setPublishableKey(wc_stripe_info.publishableKey),jQuery(function(e){function r(){if(e("#payment_method_wc_stripe").is(":checked")&&(!e('input[name="wc_stripe_card"]').length||"new"===e('input[name="wc_stripe_card"]:checked').val())&&!e("input.stripe_token").length){var r=e(".wc_stripe-card-expiry").payment("cardExpiryVal"),o={number:e(".wc_stripe-card-number").val()||"",cvc:e(".wc_stripe-card-cvc").val()||"",exp_month:r.month||"",exp_year:r.year||"",name:e(".wc_stripe-billing-name").val()||e("#billing_first_name").val()+" "+e("#billing_last_name").val()||"",address_line1:e("#billing_address_1").val()||"",address_line2:e("#billing_address_2").val()||"",address_state:e("#billing_state").val()||"",address_zip:e(".wc_stripe-billing-zip").val()||e("#billing_postcode").val()||"",address_country:e("#billing_country").val()||""};return t.block({message:null,overlayCSS:{background:"#fff url("+woocommerce_params.ajax_loader_url+") no-repeat center",opacity:.6}}),n(o)?(Stripe.createToken(o,a),!1):!0}return!0}function a(r,a){a.error?(e(".payment-errors, .stripe_token, .form_errors").remove(),$ccForm.before('<span class="payment-errors required">'+a.error.message+"</span>"),t.unblock()):(t.append('<input type="hidden" class="stripe_token" name="stripe_token" value="'+a.id+'"/>'),t.submit())}function n(r){var a=o(r);if(a.action="stripe_form_validation",a.errors.length)return e.post(wc_stripe_info.ajaxurl,a,function(r){r.indexOf("<!--WC_STRIPE_START-->")>=0&&(r=r.split("<!--WC_STRIPE_START-->")[1]),r.indexOf("<!--WC_STRIPE_END-->")>=0&&(r=r.split("<!--WC_STRIPE_END-->")[0]);var a=e.parseJSON(r);e("body").off(".wc_stripe"),e("body").on("checkout_error.wc_stripe",function(){a.messages.indexOf('<ul class="woocommerce-error">')>=0&&(a.messages=a.messages.split('<ul class="woocommerce-error">')[1]),a.messages.indexOf("</ul>")>=0&&(a.messages=a.messages.split("</ul>")[0]),e(".woocommerce-error").append(a.messages)}),e(".woocommerce-error").remove(),t.prepend(a.messages)}),e(".stripe_token, .form_errors").remove(),$ccForm.append('<input type="hidden" class="form_errors" name="form_errors" value="1">'),t.unblock(),!1;var n={errors:[]};return e.post(wc_stripe_info.ajaxurl,n),t.find(".woocommerce-error").remove(),!0}function o(r){var a={errors:[]};return r.number?e.payment.validateCardNumber(r.number)||a.errors.push({field:"number",type:"invalid"}):a.errors.push({field:"number",type:"undefined"}),r.exp_month&&r.exp_year?e.payment.validateCardExpiry(r.exp_month,r.exp_year)||a.errors.push({field:"expiration",type:"invalid"}):a.errors.push({field:"expiration",type:"undefined"}),r.cvc?e.payment.validateCardCVC(r.cvc,e.payment.cardType(r.number))||a.errors.push({field:"cvc",type:"invalid"}):a.errors.push({field:"cvc",type:"undefined"}),a}var c=e("body"),t=e("form.checkout, form#order_review");t.attr("novalidate","novalidate"),c.on("updated_checkout.wc_stripe",function(){var r=e("#wc_stripe-creditcard-form");wc_stripe_info.hasCard&&r.hide(),t.on("change",'input[name="wc_stripe_card"]',function(){"new"===e('input[name="wc_stripe_card"]:checked').val()?r.slideDown(200):r.slideUp(200)}),c.off("updated_checkout.wc_stripe")}),e("form.checkout").on("checkout_place_order_wc_stripe",function(){return r()}),e("form#order_review").on("submit",function(){return r()}),t.on("keyup change",'#card-number, #card-expiry, #card-cvc, input[name="wc_stripe_card"]',function(){e(".woocommerce_error, .woocommerce-error, .woocommerce-message, .woocommerce_message, .stripe_token, .form_errors").remove()}),e("body").on("updated_checkout",function(){e(".wc_stripe-card-number").payment("formatCardNumber"),e(".wc_stripe-card-expiry").payment("formatCardExpiry"),e(".wc_stripe-card-cvc").payment("formatCardCVC")}),e(".wc_stripe-card-number").payment("formatCardNumber").after('<span class="wc_stripe-card-image"></span>'),e(".wc_stripe-card-expiry").payment("formatCardExpiry"),e(".wc_stripe-card-cvc").payment("formatCardCVC").focus(function(){e(".wc_stripe-card-number").addClass("cvc")}).blur(function(){e(".wc_stripe-card-number").removeClass("cvc")})});
//# sourceMappingURL=./wc_stripe.min.map